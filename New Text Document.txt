
Ложим в папку  site.com/ключпокоторомухотителитьрекламу/index.php
и redirect.php c htaccess


Создайте эти три файла на вашем сервере
Убедитесь, что у PHP есть права на запись для работы с сессиями
В index.php замените в конфигурации:

site_key на ваш ключ reCAPTCHA
закодированный URL в r_data на нужный вам (предварительно закодировав его в base64)



Файлы работают следующим образом:

index.php:

Показывает форму с капчей
Обрабатывает POST запрос
Кодирует/декодирует URL
Создает временный ключ
Перенаправляет на redirect.php


redirect.php:

Получает временный ключ
Находит соответствующий URL в сессии
Выполняет финальный редирект
Очищает данные сессии


.htaccess:

Обеспечивает базовую защиту файлов
Ограничивает доступ к системным файлам
Устанавливает заголовки безопасности



Эта система обеспечивает:

Многоуровневое кодирование URL
Защиту от прямого доступа к файлам
Безопасное хранение данных в сессии
Очистку данных после использования
Базовую защиту от распространенных атак